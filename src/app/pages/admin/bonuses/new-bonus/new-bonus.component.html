<div class="absolute inset-0 flex flex-col min-w-0 overflow-y-auto bg-white c-new-bono" cdkScrollable>
    <div class="return-header">
        <mat-icon svgIcon="mat_solid:arrow_back" (click)="toBack()"></mat-icon>
        <p class="titulo-modal form-padding-title">{{modalTitle}}</p>
    </div>

    <div class="row form-padding d-flex">
        <p class="mb-6">*Campos obligatorios</p>

        <form class="col-12" [formGroup]="formData">
            <div>
                <div class="row">
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Nombre del bono</mat-label>
                                <input formControlName="bonus_name" matInput>
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="row mb-5">
                        <div class="flex flex-col mt-8 gt-sm:mt-0 gt-sm:ml-16">
                            <mat-radio-group [formControl]="radioType" class="d-flex row">
                                <div class="col-md-6">
                                    <mat-radio-button value="1" class="mb-2">
                                        <span class="font-14-500-4B5062">Campaña asignada</span>
                                    </mat-radio-button>
                                </div>
                                <div class="col-md-6">
                                    <mat-radio-button value="2" class="mb-2">
                                        <span class="font-14-500-4B5062">Actividad asignada</span>
                                    </mat-radio-button>
                                </div>
                            </mat-radio-group>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                            <mat-label>Campaña a la que aplica</mat-label>
                            <mat-select formControlName="campaign" placeholder="Seleccionar">
                                <mat-option [value]="cat.campaign_id" *ngFor="let cat of catCampaign">{{
                                    cat?.campaign_name || '-'}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class="col-md-6">
                        <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                            <mat-label>Actividad asignada</mat-label>
                            <mat-select formControlName="assigned_activity" placeholder="Seleccionar">
                                <mat-option value="1">Seguimiento a clientes</mat-option>
                                <mat-option value="2">Creación de costizaciones</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
                <hr>

                <div class="separationSection">
                    <h1>Porcentaje del bono</h1>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="flex flex-col gt-sm:mt-0 gt-sm:ml-16">
                                <mat-radio-group formControlName="type_bonus_percentage" class="d-flex row">
                                    <div class="col-md-6">
                                        <mat-radio-button [value]="1" class="mb-2">
                                            <span class="font-14-500-4B5062">Sobre avance</span>
                                        </mat-radio-button>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-radio-button [value]="2" class="mb-2">
                                            <span class="font-14-500-4B5062">Sobre ventas</span>
                                        </mat-radio-button>
                                    </div>
                                </mat-radio-group>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="row d-flex flex-column align-items-end"
                                *ngFor="let control of valuesScales; let i = index; let first = first">
                                <div class="col-md-8 d-flex align-items-center">
                                    <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                        <mat-label>Escala {{ i + 1 }}</mat-label>
                                        <input [formControl]="control.scaleNumberControl" class="text-right"
                                            type="number" matInput>
                                        <span matPrefix>%</span>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 gap-3 d-flex align-items-center justify-content-start mt-5 mb-6">
                    <button class="btn-gray color-385A6D" (click)="addFormScale()">
                        <span>Agegar escala</span>
                    </button>
                    <button *ngIf="valuesScales.length > 1" class="btn-delete-red" (click)="deleteScale()">
                        <span>Eliminar escala</span>
                    </button>
                </div>

                <br>

                <div class="row">
                    <h1>Meta del bono</h1>
                    <div class="row">
                        <div class="col-md-6" *ngIf="formData.get('type_bonus_percentage').value == '1'">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Sobre avance</mat-label>
                                <mat-select formControlName="type_bonus_meta" placeholder="Seleccionar">
                                    <mat-option [value]="1">Cantidad de llamadas
                                        logradas</mat-option>
                                    <mat-option [value]="2">Cantidad de cotizaciones
                                        realizadas</mat-option>
                                    <mat-option [value]="3">Cantidad de
                                        empresas captadas</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="row" *ngFor="let control of valuesGoalScales; let i = index; let first = first">
                        <div class="col-md-6">
                            <div class="flex flex-col gt-sm:mt-0 gt-sm:ml-16 inputsRadioGroupBold scalee">
                                <h1 class="mb-0">Escala {{ i + 1}}</h1>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="row d-flex flex-column align-items-end">
                                <div class="col-md-12 d-flex align-items-center">
                                    <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister me-5">
                                        <mat-label>Valor minimo</mat-label>
                                        <input [formControl]="control.minValueControl" class="text-right" type="number"
                                            matInput>
                                        <span matPrefix>$</span>
                                    </mat-form-field>

                                    <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                        <mat-label>Valor máximo</mat-label>
                                        <input [formControl]="control.maxValueControl" class="text-right" type="number"
                                            matInput>
                                        <span matPrefix>$</span>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <hr>

                <div class="row">
                    <h1>Base del procentaje del bono</h1>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Base del porcentaje</mat-label>
                                <mat-select formControlName="base_percentage_bonus" placeholder="Seleccionar">
                                    <mat-option [value]="1">Cantidad de llamadas logradas</mat-option>
                                    <mat-option [value]="2">Contactos alcanzados</mat-option>
                                    <mat-option [value]="3">Cotizaciones realizadas
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="col-md-6">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Importe</mat-label>
                                <input formControlName="fixed_base_income" class="text-right" matInput (input)="formatInput($event)">
                                <span matPrefix>$</span>
                            </mat-form-field>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <h1>Aplicar</h1>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Soluciones</mat-label>
                                <mat-select formControlName="bonus_solution" multiple>
                                    <mat-option [value]="cat.solution_id"
                                        *ngFor="let cat of catalogSolutions">{{cat?.solution_name ||
                                        '-'}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="col-md-6">
                            <mat-form-field class="flex-auto gt-xs:pr-3 inputNewRegister">
                                <mat-label>Agentes</mat-label>
                                <mat-select formControlName="bonus_user" multiple>
                                    <mat-option [value]="cat.id" *ngFor="let cat of catalogAgents">{{cat.first_name
                                        && cat.last_name ? cat?.first_name + ' ' + cat?.last_name : cat?.username |
                                        titlecase }}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                </div>

                <div class="row promotion">
                    <span>Fecha de vigencia del bono </span>
                    <div class="col-md-6">
                        <div class="row p-0">
                            <div class="col-md-12">
                                <mat-form-field class="flex-auto input-default inputNewRegister">
                                    <mat-date-range-input [rangePicker]="campaignOnePicker"
                                        [comparisonStart]="formData.value['init_date']"
                                        [comparisonEnd]="formData.value['deadline']">
                                        <input matStartDate placeholder="Del" formControlName="init_date" />
                                        <input matEndDate placeholder="Al" formControlName="deadline" />
                                    </mat-date-range-input>

                                    <mat-datepicker-toggle matIconSuffix
                                        [for]="campaignOnePicker"></mat-datepicker-toggle>
                                    <mat-date-range-picker #campaignOnePicker></mat-date-range-picker>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row d-flex justify-content-end align-items-center mb-3 mt-5">
                    <div class="d-flex justify-content-end col-md-3 col-xl-3 col-12 pt-md-2 mt-6">
                        <button class="btn-action-add" [disabled]="!formData.valid" (click)="actionSave()">
                            <span>Guardar</span>
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>