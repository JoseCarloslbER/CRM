<ng-container>
    <button mat-icon-button *ngIf="!opened" (click)="open()">
        <mat-icon [svgIcon]="'heroicons_outline:magnifying-glass'" style="color: white;"></mat-icon>
    </button>

    <div class="absolute inset-0 flex items-center shrink-0 z-99 bg-card" *ngIf="opened" @slideInTop @slideOutTop>
        <mat-icon class="absolute ml-6 sm:ml-8" [svgIcon]="'heroicons_outline:magnifying-glass'"></mat-icon>

        <input class="w-full h-full px-16 sm:px-18" [formControl]="searchControl" [matAutocomplete]="matAutocomplete"
            [placeholder]="'Search...'" (keydown)="onKeydown($event)" #barSearchInput>
        <mat-autocomplete class="ma sm:px-2 border-t rounded-b shadow-md" [autoSelectActiveOption]="true"
            [disableRipple]="true" #matAutocomplete="matAutocomplete">
            <mat-option class="py-0 px-6 text-md pointer-events-none text-secondary bg-transparent"
                *ngIf="resultSets && !resultSets.length">
                No encontrado!
            </mat-option>

            <ng-container *ngFor="let result of resultSets; trackBy: trackByFn">
                <mat-option
                    class="group relative mb-1 py-0 px-6 text-md rounded-md hover:bg-gray-100 dark:hover:bg-hover" (click)="seeDataCompany(result?.company_id)">
                    <ng-container *ngIf="result.company_id">
                        <ng-container *ngTemplateOutlet="contactResult; context: {$implicit: result}"></ng-container>
                    </ng-container>
                </mat-option>
            </ng-container>
        </mat-autocomplete>

        <button class="absolute top-1/2 right-5 sm:right-7 shrink-0 w-10 h-10 -mt-5" mat-icon-button (click)="close()">
            <mat-icon [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
        </button>

    </div>
</ng-container>

<ng-template #contactResult let-result>
    <div class="flex items-center">
        <div
            class="flex shrink-0 items-center justify-center w-8 h-8 rounded-full overflow-hidden bg-primary-100 dark:bg-primary-800">
            <img *ngIf="result?.avatar" [src]="result.avatar">
            <mat-icon class="m-0 icon-size-5 text-primary dark:text-primary-400" *ngIf="!result?.avatar"
                [svgIcon]="'heroicons_outline:user-circle'"></mat-icon>
        </div>
        <div class="ml-3 truncate">
            <span [innerHTML]="result.company_name"></span>
        </div>
    </div>
</ng-template>